<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: Arial, sans-serif; width: 300px; padding: 10px; }
    button { padding: 8px 10px; margin-top: 10px; display: block; width: 100%; cursor: pointer; }
    label { display: block; margin-top: 10px; font-size: 12px; }
    input[type="file"] { margin-top: 5px; width: 100%; }
    .status { margin-top: 10px; font-size: 12px; color: #555; }
    #clickCount { margin-top: 10px; font-weight: bold; }
    hr { border: 0; border-top: 1px solid #eee; margin: 10px 0; }
  </style>
  <!-- Load SheetJS in the popup to parse the upload -->
  <script src="xlsx.full.min.js"></script>
</head>
<body>
  <h3>Delta Guestbook Extractor</h3>
  
  <label>
    <strong>1. Upload Exclusion Database (Excel)</strong>
    <input type="file" id="excelInput" accept=".xlsx, .xls" />
  </label>
  <div id="fileStatus" class="status">No file loaded.</div>
  
  <hr>

  <label>
    <input type="checkbox" id="blacklistToggle" checked />
    Enable Web 2.0 Spam Filter
  </label>

  <button id="run">2. Run Extractor</button>
  <button id="stop">3. Stop & Export Difference</button>
  
  <div id="clickCount">Clicks: 0</div>
  <script src="popup.js"></script>
</body>
</html>